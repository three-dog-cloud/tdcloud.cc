import{g as j,u as O,av as A,x as P,r as y,a4 as u,ag as d,ab as o,a6 as n,a7 as s,ad as i,a5 as R,ar as m,aa as a,H as U,ah as B,aw as N,ax as q,ay as I,az as z,af as b,n as D,aj as G,ai as H}from"./assets/index-TEvEOdUJ.js";import{_ as g}from"./CgIIxLXQ.js";import{b as M,_ as E,a as F}from"./CM77qrCQ.js";import{_ as J}from"./DiCZYgCT.js";import{_ as K}from"./UrbE06DJ.js";import{_ as V}from"./BfxxwK14.js";import{_ as $}from"./Bs14_OVG.js";import{I as Q,O as W}from"./B2fpPDBJ.js";import{U as X,O as Y}from"./kVRZTP6F.js";const Z={class:"flex items-center justify-center min-h-[calc(100vh-180px)] md:min-h-[calc(100vh-145px)] px-4"},ee={class:"grid gap-4"},se={key:0,class:"flex justify-center"},te={class:"flex flex-wrap justify-center gap-2 max-w-[250px]"},oe={class:"relative"},ae={key:0,class:"relative flex justify-center text-xs uppercase"},ne={class:"grid gap-4"},re={class:"grid gap-2"},ie={class:"grid gap-2"},le={class:"flex items-center justify-between"},ue={key:1,class:"text-center text-sm"},ke=j({__name:"LoginPage",setup(ce){var v,x,w,h;const c=O(),p=A();function L(){X.requestLogin(l.value).then(t=>{z.success(b("login.success")),D(()=>{const e=G();e.setToken(t.token,t.token_timeout),e.setRefreshToken(t.refresh_token,t.refresh_token_timeout),p.push({name:"HomePage"})})}).catch(t=>{H(t.error,b("error.code")+t.code),l.value.password=""})}function S(){p.push({name:"RegisterPage"})}const _=[{icon:"logos:discourse-icon",name:"Discourse",show:(v=c.config)==null?void 0:v.discourse},{icon:"logos:github-icon",name:"Github",show:(x=c.config)==null?void 0:x.github},{icon:"logos:google-icon",name:"Google",show:(w=c.config)==null?void 0:w.google},{icon:"logos:telegram",name:"Telegram",show:(h=c.config)==null?void 0:h.telegram}],f=P(()=>_.some(t=>t.show)),l=y({username:"",password:""}),T=y(null),C=t=>{Y.getLoginAccountOAuthURL(t).then(e=>{window.location.replace(e.redirect)}).catch(e=>{W.error(e.error)})};return(t,e)=>(u(),d("div",Z,[o(s(M),{class:"w-full max-w-sm"},{default:n(()=>[o(s(E),null,{default:n(()=>[o(s(J),{class:"text-2xl text-center"},{default:n(()=>e[2]||(e[2]=[i(" 登录 ")])),_:1}),f.value?(u(),R(s(K),{key:0,class:"text-center"},{default:n(()=>e[3]||(e[3]=[i(" 请选择登录方式或输入您的账户信息 ")])),_:1})):m("",!0)]),_:1}),o(s(F),null,{default:n(()=>{var k;return[a("div",ee,[f.value?(u(),d("div",se,[a("div",te,[(u(),d(U,null,B(_,r=>q(o(s(g),{key:r.name,variant:"outline",size:"icon",class:"w-10 h-10 dark:bg-gray-500",title:r.name,onClick:de=>C(r.name.toLowerCase())},{default:n(()=>[o(s(Q),{icon:r.icon,class:"w-6 h-6"},null,8,["icon"])]),_:2},1032,["title","onClick"]),[[I,r.show]])),64))])])):m("",!0),a("div",oe,[e[5]||(e[5]=a("div",{class:"absolute inset-0 flex items-center"},[a("span",{class:"w-full border-t"})],-1)),f.value?(u(),d("div",ae,e[4]||(e[4]=[a("span",{class:"bg-background px-2 text-muted-foreground"},"或",-1)]))):m("",!0)]),a("form",{onSubmit:N(L,["prevent"])},[a("div",ne,[a("div",re,[o(s($),{for:"account"},{default:n(()=>e[6]||(e[6]=[i("账户")])),_:1}),o(s(V),{type:"text",placeholder:"请输入账户",name:"account",modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.username=r),required:""},null,8,["modelValue"])]),a("div",ie,[a("div",le,[o(s($),{for:"password"},{default:n(()=>e[7]||(e[7]=[i("密码")])),_:1})]),o(s(V),{type:"password",name:"password",placeholder:"请输入密码",modelValue:l.value.password,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.password=r),required:""},null,8,["modelValue"])]),o(s(g),{type:"submit",class:"w-full",disabled:T.value!==null},{default:n(()=>e[8]||(e[8]=[i(" 登录 ")])),_:1},8,["disabled"])])],32),(k=s(c).config)!=null&&k.register?(u(),d("div",ue,[e[10]||(e[10]=i(" 还没有账户? ")),o(s(g),{variant:"link",class:"px-0 h-auto",onClick:S},{default:n(()=>e[9]||(e[9]=[i("注册")])),_:1})])):m("",!0)])]}),_:1})]),_:1})]))}});export{ke as default};
